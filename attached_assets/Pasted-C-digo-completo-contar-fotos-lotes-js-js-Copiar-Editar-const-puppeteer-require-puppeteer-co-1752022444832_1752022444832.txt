CÃ³digo completo â€” contar_fotos_lotes.js
js
Copiar
Editar
const puppeteer = require('puppeteer');

const AUCTION_URL = 'https://northcountry.auctiontechs.com/auction-detail/174912699568418f53a4cac';
const AUCTION_ID = '174912699568418f53a4cac';

(async () => {
  const browser = await puppeteer.launch({
    headless: true,
    args: ['--no-sandbox']
  });

  const page = await browser.newPage();
  await page.goto(AUCTION_URL, { waitUntil: 'networkidle2' });

  console.log('ğŸŒ€ Obteniendo todos los lotes de la pÃ¡gina 1...');
  await page.waitForSelector('a[href*="item-detail"]');

  // Scroll por si hay lazy loading
  for (let i = 0; i < 6; i++) {
    await page.evaluate(() => window.scrollBy(0, window.innerHeight));
    await new Promise(resolve => setTimeout(resolve, 600));
  }

  // Obtener todos los IDs de lotes Ãºnicos
  const lotes = await page.$$eval('a[href*="/item-detail"]', links => {
    const seen = new Set();
    return links.map(link => {
      const href = link.getAttribute('href');
      const id = href?.split('/item-detail/')[1]?.split('?')[0];
      if (id && !seen.has(id)) {
        seen.add(id);
        return id;
      }
      return null;
    }).filter(Boolean);
  });

  console.log(`ğŸ” Se encontraron ${lotes.length} lotes.\n`);

  const resultados = [];

  for (const id of lotes) {
    const loteURL = `https://northcountry.auctiontechs.com/item-detail/${id}?auction_id=${AUCTION_ID}`;
    await page.goto(loteURL, { waitUntil: 'domcontentloaded' });
    await page.waitForTimeout(600);

    // Contar las imÃ¡genes del carrusel
    let count = await page.$$eval('.slick-track img', imgs => imgs.length);

    // OpciÃ³n secundaria: leer contador visual "1 / 22"
    const textoContador = await page.$eval('.slick-counter', el => el.innerText).catch(() => '');
    const matches = textoContador.match(/\/\s*(\d+)/);
    if (matches) {
      count = parseInt(matches[1], 10);
    }

    const title = await page.$eval('.item-detail-title', el => el.innerText).catch(() => `Lote ${id}`);

    resultados.push({ id, title, fotos: count });
    console.log(`âœ… ${title} â†’ ${count} fotos`);
  }

  console.log('\nğŸ“Š Tabla resumen:\n');
  console.table(resultados);

  await browser.close();
})();
âœ… Resultado esperado
Cuando lo ejecutas con:

bash
Copiar
Editar
node contar_fotos_lotes.js
VerÃ¡s una tabla como esta:

bash
Copiar
Editar
Lotes encontrados: 40

âœ… Lot 77 - Peugeot Landtrek Action 4x4 â†’ 22 fotos
âœ… Lot 78 - Komatsu Bulldozer D65EX â†’ 8 fotos

ğŸ“Š Tabla resumen:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ (index) â”‚     id       â”‚                 title                   â”‚ fotos â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    0    â”‚ '6862f9c8...'â”‚ 'Lot 77 - Peugeot Landtrek 4x4 HDi'     â”‚  22   â”‚
â”‚    1    â”‚ '686466bb...'â”‚ 'Lot 78 - Komatsu D65EX Bulldozer'      â”‚   8   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
ğŸ§© Â¿QuÃ© puedes hacer luego?
Subir la informaciÃ³n a Supabase automÃ¡ticamente

Descargar las fotos desde Cloudinary

Crear una vista web con filtros, bÃºsqueda, favoritos, etc.

O integrarlo al dashboard de Replit directamente

Pide esa versiÃ³n extendida si la necesitas.

yaml
Copiar
Editar

---

Â¿Quieres que tambiÃ©n te lo prepare como `.zip` o `.txt` descargable desde acÃ¡? Te lo armo al ti